<%= render "shared/header" %>

<div class="index">
  <ul class="tweet-lists">
    <li class='tweet-list'>

      <div class="tweet-listTop">
        <% if @tweet.user.image.attached? %>
          <%= image_tag @tweet.user.image.variant(resize: '50x50'), class: "user-img" %>
        <% end %>
        <div class="user-name"><%= @tweet.user.name %></div>
      </div>

      <div class="tweet-listMain">
        <% if @tweet.image.attached? %>
          <%= image_tag @tweet.image, class: "tweet-img" %>
        <% end %>
      </div>

      <div class="tweet-listBottom">
        <div class="tweet-ttl"><%= @tweet.title %></div>
        <div class="tweet-txt"><%= @tweet.text %></div>
        <div class="tweet-job">見て欲しい人の職業,状況：<%= @tweet.job.name %></div>
        <div class="tweet-status">見て欲しい人の心境,状態：<%= @tweet.status.name %></div>
        <div class="tweet-option">
          <div class="tweet-day"><%= time_ago_in_words(@tweet.created_at) %>前</div>
          <% if user_signed_in? && current_user.id == @tweet.user_id %>
            <div class="tweet-sub">
              <%= link_to edit_tweet_path(@tweet.id), class: "edit-btn" do %>
                <i class="far fa-edit"></i>
              <% end %>
              <%= link_to tweet_path(@tweet.id), method: :delete, class: "destroy-btn" do %>
                <i class="fas fa-trash"></i>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>

    </li>
  </ul>

  <div class="comment">
    <% if user_signed_in? %>
      <%= form_with(model: [@tweet, @comment], local: true) do |form| %>
        <%= form.text_area :text, placeholder: "コメントする", rows: "2" %>
        <%= form.submit "SEND" %>
      <% end %>
    <% else %>
      <strong><p>※※※ コメントの投稿には新規登録/ログインが必要です ※※※</p></strong>
    <% end %>
    <div class="comment-lists">
      <h4>＜コメント一覧＞</h4>
      <% @comments.each do |comment| %>
        <div class="comment-list">
          <%= link_to comment.user.name, user_path(comment.user_id) %>：
          <%= comment.text %>
        </div>
      <% end %>
    </div>
  </div>

</div>